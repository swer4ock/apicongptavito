<h1>Подключение к искусственному интеллекту</h1>

<p><strong>Внимание:</strong> Этот репозиторий создан исключительно в учебных целях.</p>

<h2>1. Подписка на вебхуки</h2>
<p>Вам необходимо подписаться на вебхуки по адресу <code>aichanow.ru/webhook</code>.</p>

<h2>2. Создание структуры каталогов</h2>
<p>В корневой директории проекта создайте папку с именем, соответствующим номеру вашего аккаунта. В этой папке создайте подкаталог для объявлений, имя которого должно быть написано транслитом на основе русского слова. Например, если название каталога на русском "тележка", то в системе оно должно быть указано как <code>telegka</code>.</p>

<h2>3. Работа с данными</h2>
<p>В соответствующую категорию товаров поместите JSON-файл с информацией (<code>know.json</code>).</p>

<h2>4. Обработка вебхуков</h2>
<p>Когда Авито отправляет вебхук, данные обрабатываются скриптом <code>avito2.php</code>, который разбивает их на различные массивы для дальнейшего анализа.</p>

<h2>5. Интеграция с OpenAI</h2>
<p>Данные массивов передаются в скрипт <code>ai_processing.php</code>, который отвечает за интеграцию с библиотекой OpenAI и получение дополнительных данных, таких как заголовок и цена товара.</p>

<h2>6. Основной процесс обработки</h2>
<p>Далее запускается <code>avito-aigpt.php</code>, который содержит функции для обработки данных:</p>
<ul>
    <li><code>processMessage</code>: Сортировка категорий запросов.</li>
    <li><code>generateAnswer</code>: Настройка параметров модели ИИ.</li>
    <li><code>getAnswer</code>: Создание ответа, работа с "библиотекарем".</li>
    <li><code>transliterate</code>: Транслитерация текста.</li>
    <li><code>process_client_message</code>: Обработка клиентских сообщений и ответы на них.</li>
</ul>

<h2>7. Ключевые функции</h2>
<p>Некоторые важные функции и массивы:</p>
<ul>
    <li><code>$keywords</code>: Массив ключевых слов для категорий, например:
        <pre><code>$keywords = [
    'Производство' => 'franshiza',
    'Администратор' => 'vakansiya',
    'Авитолог' => 'avitolog',
    'тележка' => 'telegka',
];</code></pre>
    </li>
    <li><code>saveAnswer</code>: Сохранение ответов и работа с директориями.</li>
    <li><code>find_product</code>: Поиск продукта.</li>
    <li><code>AiChatNow</code>: Основная функция, которая управляет взаимодействием всех остальных функций.</li>
    <li><code>getChatHistory</code>: Чтение истории чатов (<code>history/avito_chat_{$chat_id}.log</code>).</li>
    <li><code>AvitoSubmit</code>: Отправка сообщений от ИИ.</li>
    <li><code>check_message_read_status</code>: Проверка статуса прочтения сообщений.</li>
</ul>

<h2>8. Логирование вебхуков</h2>
<p>Процесс логирования всех получаемых данных вебхуков.</p>

<h2>9. Получение API-ключа Авито</h2>
<p>Вам необходимо получить API-ключ Авито и указать адрес <code>aichatnow.ru</code> для получения данных.</p>

<h2>10. Основные файлы для работы</h2>
<p>Ключевые файлы в проекте:</p>
<ul>
    <li><code>Avito-aigpt.php</code>: Главный файл, отвечающий за отправку сообщений и содержащий массив объявлений для ответов.</li>
    <li><code>Avcon.php</code>: Получение токена.</li>
    <li><code>Av-submit.php</code>: Проверка API-ключа.</li>
    <li><code>Avito-ai.php</code>: Основная функция для работы с <code>aichatnow</code>.</li>
</ul>

<h2>11. Настройка и подписка на вебхуки</h2>
<ol>
    <li>Перейдите по адресу <code>aichatnow.ru/НОМЕРКАБИНЕТА/avcon.php</code>, чтобы получить токен. Вставьте этот токен в файлы <code>webhook.php</code> и <code>webhooksubscrib.php</code>.</li>
    <li>Перейдите на страницу <code>aichatnow.ru/webhook.php</code> и подпишитесь на вебхуки по адресу <code>https://aichatnow.ru/avito2.php</code>. Если вы видите сообщение <code>ok true</code>, значит подписка успешна и вебхук работает.</li>
    <li>Перейдите на <code>aichatnow.ru/webhooksubscrib.php</code>, чтобы проверить список подписок (возможно, этот файл уже устарел).</li>
</ol>
